{
    "rules": {
        "pairings": {
            "$pairingCode": {
                ".read": "auth != null",
                ".write": "auth != null",
                "selectedObjects": {
                    ".validate": "newData.isString() || newData.hasChildren()"
                },
                "timestamp": {
                    ".validate": "newData.isNumber()"
                },
                "devices": {
                    "camera": {
                        ".validate": "newData.hasChildren(['userId', 'timestamp'])"
                    },
                    "monitor": {
                        ".validate": "newData.hasChildren(['userId', 'timestamp'])"
                    }
                },
                "alerts": {
                    "$alertId": {
                        ".validate": "newData.hasChildren(['objectLabel', 'timestamp'])"
                    }
                }
            }
        },
        "users": {
            "$userId": {
                ".read": "$userId === auth.uid",
                ".write": "$userId === auth.uid",
                "pairingCodes": {
                    ".validate": "newData.hasChildren()"
                },
                "devices": {
                    "$deviceId": {
                        ".validate": "newData.hasChildren(['pairingCode', 'role', 'timestamp'])"
                    }
                }
            }
        }
    }
}